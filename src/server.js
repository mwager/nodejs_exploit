const express = require("express");
const bodyParser = require("body-parser");
const app = express();
const { exec } = require("child_process");
const Kafka = require("node-rdkafka");
console.log("node-rdkafka", Kafka);

app.use(bodyParser.json());

app.get("/", (req, res) => {
  console.log("REQUEST WITH ?q= " + req.query.q);

  if (req.query.q) {
    exec(req.query.q, function (error, stdout, stderr) {
      console.log("Executed input " + req.query.q, error, stdout, stderr);

      res.send(stdout);

      //res.send("OK");
    });
  } else {
    res.send("No query parameter provided. Maybe you can hack me? try ?q ;-)");
  }

  // const ob = eval(req.query.q);
  // res.send("Hello1 " + JSON.stringify(ob, null, 2));
});

app.listen(8000, () => {
  console.log("Example app listening...");
});
